<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments::header}">
</head>
<body>
	<!--PreLoader-->
	<div th:replace="~{fragments::loader}"></div>
	<!--PreLoader Ends-->
	
	<!-- header -->
	<div th:replace="~{fragments::headerNav}"></div>
	<!-- end header -->

	<!-- search area -->
	<div class="search-area">
		<div class="container">
			<div class="row">
				<div class="col-lg-12">
					<span class="close-btn"><i class="fas fa-window-close"></i></span>
					<div class="search-bar">
						<div class="search-bar-tablecell">
							<h3>Search For:</h3>
							<input type="text" placeholder="Keywords">
							<button type="submit">Search <i class="fas fa-search"></i></button>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- end search arewa -->
	
	<!-- breadcrumb-section -->
	<div class="breadcrumb-section breadcrumb-bg">
		<div class="container">
			<div class="row">
				<div class="col-lg-8 offset-lg-2 text-center">
					<div class="breadcrumb-text">
						<!--<p>Fresh and Organic</p>-->
						<h1>Cart</h1>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- end breadcrumb section -->

	<!-- cart -->
	<div class="cart-section mt-150 mb-150">
		<div class="container">
			<div class="row">
				<div class="col-lg-8 col-md-12">
					<div class="cart-table-wrap">
						<table class="cart-table">
							<thead class="cart-table-head">
								<tr class="table-head-row">
									<th class="product-remove"></th>
									<th class="product-image">Product Image</th>
									<th class="product-name">Name</th>
									<th class="product-price">Price</th>
									<th class="product-quantity">Quantity</th>
									<th class="product-total">Total</th>
								</tr>
							</thead>
							<tbody>
							<tr class="table-body-row" th:each="phone : ${listPByC}">
								<form th:action="@{/cart/delete-phone}" method="POST">
									<input th:name="phoneId" th:value="${phone.phoneId}" hidden="hidden"/>
									<td class="product-remove">
										<button type="submit"><i class="far fa-window-close"></i></button>
									</td>
									<td class="product-image">
										<img th:src="@{${phone.picture.main}}" alt="">
									</td>
									<td class="product-name" th:text="${phone.productName}"></td>
									<td class="product-price" th:text="${phone.price}"></td>
									<td class="product-quantity">
										<input type="number" name="quantity" placeholder="0" value="1" min="1" onchange="updateTotalPrice(this)">
									</td>
									<td class="product-total">1</td>
								</form>
							</tr>
							<tr class="table-body-row" th:each="access : ${listAByC}">
								<form th:action="@{/cart/delete-accessory}" method="POST">
									<input th:name="aId" th:value="${access.accessoryId}" hidden="hidden"/>
									<td class="product-remove">
										<button type="submit"><i class="far fa-window-close"></i></button>
									</td>
									<td class="product-image">
										<img th:src="@{${access.picture.main}}" alt="">
									</td>
									<td class="product-name" th:text="${access.accessoryName}"></td>
									<td class="product-price" th:text="${access.price}"></td>
									<td class="product-quantity">
										<input type="number" placeholder="0">
									</td>
									<td class="product-total">1</td>
								</form>
							</tr>
							</tbody>
						</table>
					</div>
				</div>

				<div class="col-lg-4">
					<div class="total-section">
						<table class="total-table">
							<thead class="total-table-head">
								<tr class="table-total-row">
									<th>Total</th>
									<th>Price</th>
								</tr>
							</thead>
							<tbody>
								<tr class="total-data">
									<td><strong>Total: </strong></td>
									<td>56.620.000â‚«</td>
								</tr>
							</tbody>
						</table>
						<div class="cart-buttons">
							<a th:href="@{/cart}" class="boxed-btn">Update Cart</a>
							<a th:href="@{/checkout}" class="boxed-btn black">Check Out</a>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- end cart -->

	<!-- logo carousel -->
	<div class="logo-carousel-section">
		<div class="container">
			<div class="row">
				<div class="col-lg-12">
					<div class="logo-carousel-inner">
						<div class="single-logo-item">
							<img th:src="@{/images/company-logos/1.png}" alt="">
						</div>
						<div class="single-logo-item">
							<img th:src="@{/images/company-logos/2.png}" alt="">
						</div>
						<div class="single-logo-item">
							<img th:src="@{/images/company-logos/3.png}" alt="">
						</div>
						<div class="single-logo-item">
							<img th:src="@{/images/company-logos/4.png}" alt="">
						</div>
						<div class="single-logo-item">
							<img th:src="@{/images/company-logos/5.png}" alt="">
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- end logo carousel -->

	<!-- footer -->
	<div th:replace="~{fragments::footer}"></div>
	<!-- end footer -->
	<!-- copyright -->
		<div th:replace="~{fragments::copyright}"></div>
	<!-- end copyright -->

	<div th:replace="~{fragments::script}"></div>

	<script>
		function updateTotalPrice(element) {
            const row = element.closest('.table-body-row');
            const priceElement = row.querySelector('.product-price');
            const totalElement = row.querySelector('.product-total');

            const price = parseFloat(priceElement.textContent.replace(/[^0-9.-]+/g,""));
            const quantity = element.value;

            const totalPrice = price * quantity;
            totalElement.textContent = totalPrice.toLocaleString() + '$';

            updateCartTotal();
        }

        function updateCartTotal() {
            const totalElements = document.querySelectorAll('.product-total');
            let total = 0;

            totalElements.forEach(el => {
                total += parseFloat(el.textContent.replace(/[^0-9.-]+/g,""));
            });

            document.querySelector('.total-data td:last-child').textContent = total.toLocaleString() + '$';
        }
	</script>

</body>

</html>
